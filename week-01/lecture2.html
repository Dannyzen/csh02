<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CS For Hackers - Lecture 1.2</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="file:///Library/Python/2.7/site-packages/landslide/themes/default/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="file:///Library/Python/2.7/site-packages/landslide/themes/default/css/screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="file:///Library/Python/2.7/site-packages/landslide/themes/default/js/slides.js"></script>
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>CS For Hackers - Lecture 1.2</h1></header>
            
            
            <section><p>What are we going to cover?</p>
<ul>
<li>System layout</li>
<li>Interrupts</li>
<li>Hierarchy of caches</li>
<li>Pipelining</li>
<li>Branch prediction</li>
<li>Context switching</li>
</ul>
<style>
td, th { padding: 5px; }
table { padding: 0 20px; }
</style></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              1/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>A "Real" ALU</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/1-bit-alu.png"
style="max-height: 80%; max-width: 80%;">

<p><a href="https://github.com/generalassembly/cs-for-hackers/raw/master/week-01/circuits/1-bit-alu.cir">download circuit</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              2/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>The Von Neumann Machine</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/von-neumann.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              3/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Playing Computer</h1></header>
            
            
            <section><h2>Quiz from last time</h2>
<ul>
<li>Start with the system state below.</li>
<li>What is the value of register B by the end of the program?</li>
</ul>
<table style="float:left">
<tr><th>Instruction</th><th>Action</th><th>Opcode</th></tr>
<tr><td>nop</td><td>nothing</td><td>0000</td></tr>
<tr><td>add</td><td>X = X + Y</td><td>0001</td></tr>
<tr><td>sub</td><td>X = X - Y</td><td>0010</td></tr>
<tr><td>and</td><td>X = X & Y</td><td>0011</td></tr>
<tr><td>or</td><td>X = X | Y</td><td>0100</td></tr>
<tr><td>xor</td><td>X = X ^ Y</td><td>0101</td></tr>
<tr><td>mv</td><td>X = Y</td><td>0110</td></tr>
<tr><td>load</td><td>X = MEM</td><td>0111</td></tr>
<tr><td>store</td><td>MEM = X</td><td>1000</td></tr>
</table>

<table style="float:left">
<tr><th>Register</th><th>Index</th><th>Contents</th></tr>
<tr><td>A</td><td>0000</td><td>0001</td></tr>
<tr><td>B</td><td>0001</td><td>0101</td></tr>
<tr><td>PC</td><td>0010</td><td>0010</td></tr>
</table>

<table style="float:left">
<tr><th>Memory Address</th><th>Contents</th></tr>
<tr><td>0000</td><td>0101 0010 0010</td></tr>
<tr><td>0001</td><td>0000 0000 0000</td></tr>
<tr><td>0010</td><td>0001 0000 0001</td></tr>
<tr><td>0011</td><td>0011 0001 0000</td></tr>
</table></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              4/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Playing Computer (worked out)</h1></header>
            
            
            <section><p>First, it is easier to see what is going on if we translate the contents of
memory (the program that is going to execute) into a format that we can read
more easily. Here, I just translate the binary codes and put a comma between
the operands, which is how most assembly language looks:</p>
<table>
<tr><th>Memory Address</th><th>Contents</th></tr>
<tr><td>0000</td><td>xor PC, PC;</td></tr>
<tr><td>0001</td><td>nop;</td></tr>
<tr><td>0010</td><td>add A, B;</td></tr>
<tr><td>0011</td><td>and B, A;</td></tr>
</table>

<table>
<tr><th>Register</th><th>Index</th><th>Contents</th></tr>
<tr><td>A</td><td>0000</td><td>0001</td></tr>
<tr><td>B</td><td>0001</td><td>0101</td></tr>
<tr><td>PC</td><td>0010</td><td>0010 # what?? a trick!</td></tr>
</table></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              5/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><p>So, starting off from memory location 0010 (2), we have the following instructions:</p>
<pre><code>add A, B;
and B, A;
</code></pre>
<p>We can carry them out by hand (it might be helpful to refer to the truth table for
addition and AND):</p>
<pre><code>  0001 A
+ 0101 B
------
  0110 A

  0110 A 
&amp; 0101 B
------
  0100 B
</code></pre>
<p>W00t! Violá! QED. &#8718;. We have our answer:</p>
<blockquote>
<p>What is the value of register B by the end of the program? <strong>0100</strong> or <strong>5</strong></p>
</blockquote></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              6/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>System Layout</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              7/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>The Von Neumann Machine</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/von-neumann.png"
style="max-height: 90%; max-width: 80%;">

<ul>
<li>We will zoom out from here.</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              8/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>A Typical CPU</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/cpu-layout.png"
style="max-height: 90%; max-width: 80%;">

<!--
- Separate data and instruction caches.
- Interconnects
--></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              9/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>A Typical System</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/system-layout.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              10/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Aside: Interrupts</h1></header>
            
            
            <section><p>This is how things interact with the CPU</p>
<ul>
<li>Hardware Interrupts</li>
<li>Like a prankster deliveryperson, drop some data somewhere and ring the doorbell (light up an interrupt wire)</li>
<li>The PC jumps to an <em>interrupt handler</em> somewhere in memory</li>
<li>Remember IRQs?</li>
<li>Software Interrupts</li>
<li>Call a kernel or BIOS function</li>
</ul>
<p>Example:</p>
<pre><code>mov ax, 0000000000010011b;
int 10h; # set graphics mode
mov ax, 0000110000001100b;
mov cx, 0000000000001010b;
mov dx, 0000000000001111b;
int 10h; # set pixel
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              11/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>A Typical System</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/system-layout.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              12/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>How you should actually think of it</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/orders-of-magnitude.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              13/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Orders of magnitude</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/orders-of-magnitude-anthro.png"
style="max-height: 80%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              14/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Remember The Secret?</h1></header>
            
            
            <section><blockquote>
<p><em>Computers are a hierarchy of caches that are fast in the average case.</em></p>
</blockquote>
<p>Well, there is a reason behind it...</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              15/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>The Locality Principle</h1></header>
            
            
            <section><blockquote>
<p><em>If you accessed something, you will probably end up accessing its neighbor.</em></p>
</blockquote>
<h2>A.K.A.</h2>
<ul>
<li>Locality of reference (theorists)</li>
<li>Cache locality (systems people)</li>
<li>Data locality (big data pundits)</li>
</ul>
<h2>Facets</h2>
<ul>
<li>Temporal locality<ul>
<li>Things that were just accessed will tend to get accessed again</li>
</ul>
</li>
<li>Spacial locality<ul>
<li>Things that are nearby in memory will get accessed</li>
</ul>
</li>
</ul>
<p>Can you think of examples?</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              16/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Applications of locality</h1></header>
            
            
            <section><p>How do <em>you</em> think locality affects the following things:</p>
<ul>
<li>Searching the web</li>
<li>Web performance</li>
<li>Games</li>
<li>Big Data</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              17/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Hit ratio</h1></header>
            
            
            <section><p>Ryan, you keep saying "fast in the average case". What is the average case?</p>
<pre><code>h = hit ratio
c = cache access time
m = memory access time

average access time = c + (1-h) * m
</code></pre>
<p>Notice something:</p>
<pre><code># hit ratio --&gt; 0
average access time = c + m

# hit ratio --&gt; 1
average access time = c
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              18/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Quiz</h1></header>
            
            
            <section><pre><code>average access time = c + (1-h) * m
</code></pre>
<ul>
<li>
<p>How fast is the average access if you have a <code>1 ns</code> cache,
a <code>100 ns</code> memory, and a hit ratio of <code>0.5</code>? What about <code>0.9</code>?</p>
</li>
<li>
<p>What do you think the hit ratio will be for fetching code?</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              19/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Our simple jumping computer</h1></header>
            
            
            <section><table style="float:left">
<tr><th>Instruction</th><th>Action</th></tr>
<tr><td>nop</td><td>nothing</td></tr>
<tr><td>add</td><td>X = X + Y</td></tr>
<tr><td>sub</td><td>X = X - Y</td></tr>
<tr><td>and</td><td>X = X & Y</td></tr>
<tr><td>or</td><td>X = X | Y</td></tr>
<tr><td>xor</td><td>X = X ^ Y</td></tr>
<tr><td>mv</td><td>X = Y</td></tr>
<tr><td>load</td><td>Y = mem[X]</td></tr>
<tr><td>store</td><td>mem[X] = Y</td></tr>
<tr><td>jz</td><td>if X == 0, PC = Y</td></tr>
<tr><td>jnz</td><td>if X != 0, PC = Y</td></tr>
<!--tr><td>jnz</td><td>if X != 0, PC = Y</td></tr-->
<!--tr><td>srs</td><td>MEM[X] = registers</td></tr-->
<!--tr><td>rrs</td><td>registers = mem[X]/td></tr-->
</table>

<table style="float:left">
<tr><th>Register</th><th>Contents</th></tr>
<tr><td>A</td><td>1010</td></tr>
<tr><td>B</td><td>0001</td></tr>
<tr><td>PC</td><td>0000</td></tr>
<!--tr><td>BP</td><td>0000</td></tr-->
</table>

<table style="float:left">
<tr><th>Memory Address</th><th>Contents</th></tr>
<tr><td>0000</td><td>nop;</td></tr>
<tr><td>0001</td><td>sub A, B;</td></tr>
<tr><td>0010</td><td>nop; # imagine these</td></tr>
<tr><td>0011</td><td>nop; # nop instructions</td></tr>
<tr><td>0100</td><td>nop; # do something</td></tr>
<tr><td>0101</td><td>nop; # useful :)</td></tr>
<tr><td>0110</td><td>nop;</td></tr>
<tr><td>0111</td><td>jnz A, B;</td></tr>
<tr><td>1000</td><td>nop; # these</td></tr>
<tr><td>1001</td><td>nop; # too</td></tr>
<tr><td>1010</td><td>nop;</td></tr>
<tr><td>1011</td><td>nop;</td></tr>
<tr><td>1100</td><td>nop;</td></tr>
<tr><td>1101</td><td>nop;</td></tr>
<tr><td>1110</td><td>nop;</td></tr>
<tr><td>1111</td><td>nop;</td></tr>
</table></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              20/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Question</h1></header>
            
            
            <section><ul>
<li>What does this thing do?</li>
<li>How fast will it execute?</li>
<li>What assumptions do you have to make?</li>
</ul>
<p>Given:</p>
<ul>
<li>Our cache is 8 instructions in size</li>
<li>Fetching an instruction from cache takes 1 cycle</li>
<li>Fetching an instruction from memory takes 10 cycles, but 8
  instructions are always fetched at a time</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              21/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>It gets worse (or better)</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              22/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>A Generic Pipeline</h1></header>
            
            
            <section><ul>
<li>Each instruction is divided up into several steps</li>
<li>The steps happen (or can happen) in <em>serial</em></li>
<li>Does this not wake your inner industrialist?</li>
</ul>
<img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/pipeline-overview.png"
style="max-height: 90%; max-width: 80%;">

<ul>
<li>How long does it take to make a car?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              23/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Cars</h1></header>
            
            
            <section><ul>
<li>How long does it take to make a car?<blockquote>About 24 hours </blockquote>
</li>
<li>
<p>How many cars does a factory make an hour?</p>
<blockquote>
<p>Maybe 50-100</p>
</blockquote>
</li>
<li>
<p>And why is that?</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              24/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Pipeline In Context</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/pipeline-cpu.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              25/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Pipeline Timeline</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/pipeline.png"
style="max-height: 90%; max-width: 80%;">

<p>Note:</p>
<ul>
<li>Pipelines can get very long.</li>
<li>ARM Cortex-A8 (iPhone 3G) has 13 stages!</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              26/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Question</h1></header>
            
            
            <section><ul>
<li>What happens when you hit a conditional jump?</li>
<li>What stage does the conditional jump occur?</li>
</ul>
<img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/pipeline-question.png"
style="max-height: 90%; max-width: 80%;"></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              27/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Branch prediction</h1></header>
            
            
            <section><h2>Manual</h2>
<pre><code>#define likely(x)       __builtin_expect((x),1)
#define unlikely(x)     __builtin_expect((x),0)

if (unlikely(y &gt; 0)) {
    ...
}

if (likely(x &gt; y)) {
    ...
}
</code></pre>
<h2>Automatic</h2>
<ul>
<li>How would you do it?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              28/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Second Chance Machine</h1></header>
            
            
            <section><img src="file:///Users/ryan/Dropbox/Writing Kit/cs-for-hackers/week-01/img/state-machine.png"
style="max-height: 90%; max-width: 80%;">

<ul>
<li>This is called a state machine.</li>
<li>How would you implement it in code?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              29/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Question</h1></header>
            
            
            <section><ul>
<li>How would you run more than one program at a time?</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              30/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Context Switching Computer</h1></header>
            
            
            <section><ul>
<li>We add BP (base pointer), srs (save register state), rrs (restore register state)</li>
<li>How would you use this to run more than one program?</li>
</ul>
<table style="float:left">
<tr><th>Instruction</th><th>Action</th></tr>
<tr><td>nop</td><td>nothing</td></tr>
<tr><td>add</td><td>X = X + Y</td></tr>
<tr><td>sub</td><td>X = X - Y</td></tr>
<tr><td>and</td><td>X = X & Y</td></tr>
<tr><td>or</td><td>X = X | Y</td></tr>
<tr><td>xor</td><td>X = X ^ Y</td></tr>
<tr><td>mv</td><td>X = Y</td></tr>
<tr><td>load</td><td>Y = mem[X+BP]</td></tr>
<tr><td>store</td><td>mem[X+BP] = Y</td></tr>
<tr><td>jz</td><td>if X == 0, PC = Y+BP</td></tr>
<tr><td>jnz</td><td>if X != 0, PC = Y+BP</td></tr>
<tr><td>srs</td><td>mem[X] = registers</td></tr>
<tr><td>rrs</td><td>registers = mem[X]</td></tr>
<tr><td>ljz</td><td>if X == 0, PC = Y</td></tr>
<tr><td>ljnz</td><td>if X != 0, PC = Y</td></tr>
</table>

<table style="float:left">
<tr><th>Register</th><th>Contents</th></tr>
<tr><td>A</td><td>1010</td></tr>
<tr><td>B</td><td>0001</td></tr>
<tr><td>PC</td><td>0000</td></tr>
<tr><td>BP</td><td>0000</td></tr>
</table>

<!--
----

# What does a CPU look like?

<a href="http://www.flickr.com/photos/biwook/153056995/" title="Old processor's die by Ioan Sameli, on Flickr"><img src="http://farm1.staticflickr.com/64/153056995_5ef8b01016.jpg" width="500" height="386" alt="Old processor's die"></a>

----
# How is it made?
--></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              31/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>What did we learn?</h1></header>
            
            
            <section><ul>
<li>System layout</li>
<li>Interrupts</li>
<li>Hierarchy of caches</li>
<li>Pipelining</li>
<li>Branch prediction</li>
<li>Context switching</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              32/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Learn more</h1></header>
            
            
            <section><ul>
<li><a href="http://wiki.osdev.org/Main_Page">OSDev Wiki</a><ul>
<li>Some people build OSes from scratch for fun.</li>
<li>They learn a lot about hardware along the way!</li>
</ul>
</li>
<li>
<p>"Elements of Computing Systems" Nisan and Schocken</p>
<ul>
<li>Held in high regard</li>
<li>Build a computer from scratch</li>
<li><a href="http://www.amazon.com/Elements-Computing-Systems-Building-Principles/dp/026214087X">~$20 on Amazon</a>, but many chapters available <a href="http://www1.idc.ac.il/tecs/">online</a></li>
</ul>
</li>
<li>
<p>"The Art of Assembly Language Programming" Randall Hyde</p>
<ul>
<li>A classic! Shift bits like a pro!</li>
<li>available <a href="http://homepage.mac.com/randyhyde/webster.cs.ucr.edu/www.artofasm.com/index.html">online</a></li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              33/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Fin</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              34/35
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture2.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Hacking Challenge</h1></header>
            
            
            <section><p>Background reading:
<a href="http://igoro.com/archive/gallery-of-processor-cache-effects/">http://igoro.com/archive/gallery-of-processor-cache-effects/</a></p>
<ul>
<li>What kind of caches does your computer have? What are their sizes?<br />
</li>
<li>Write a program (in a language of your choice) that shows convincing evidence
  of your computer’s caches in operation. Can you determine the cache size by
  plotting the time taken by different access patterns?  You might have to get
  creative if your language is dynamic, reading up on how data types are stored
  and how big they are.</li>
</ul>
<p>Try to get the above done in less than 4 focused hours.</p>
<p><em>Bonus question:</em> Can you write a program that shows the effects of branch
prediction? Can you trip up the branch predictor and slow down your program?
How much does branch prediction matter versus cache locality for the programs
you write every day?</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="lecture2.md">lecture2.md</a>
            </aside>
            
            <aside class="page_number">
              35/35
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">CS For Hackers - Lecture 1.2</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">A "Real" ALU</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">The Von Neumann Machine</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">Playing Computer</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Playing Computer (worked out)</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">-</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">System Layout</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">The Von Neumann Machine</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">A Typical CPU</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">A Typical System</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">Aside: Interrupts</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">A Typical System</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">How you should actually think of it</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Orders of magnitude</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">Remember The Secret?</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">The Locality Principle</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Applications of locality</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Hit ratio</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Quiz</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">Our simple jumping computer</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Question</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">It gets worse (or better)</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">A Generic Pipeline</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">Cars</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">Pipeline In Context</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">Pipeline Timeline</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">Question</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Branch prediction</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Second Chance Machine</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">Question</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">Context Switching Computer</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">What did we learn?</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">Learn more</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
      <tr id="toc-row-34">
        <th><a href="#slide34">Fin</a></th>
        <td><a href="#slide34">34</a></td>
      </tr>
      
      
      <tr id="toc-row-35">
        <th><a href="#slide35">Hacking Challenge</a></th>
        <td><a href="#slide35">35</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>